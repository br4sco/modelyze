include DILLEXPORT
include DILLSIM

def n_1, n_2, n_3: Node

def m = 1.
def I = 1.
def x_m, y_m: Real
def vx_m, vy_m: Real
def Fx_m, Fy_m: Real
def th_m, om_m, T_m: Real
def rr_m = vec x_m y_m
def vv_m = vec vx_m vy_m
def FF_m = vec Fx_m Fy_m

def b = Body m
             I
             rr_m
             vv_m
             FF_m
             th_m
             om_m
             T_m
             n_1 n_3

def l = 1.
def ra = ARigidArm l n_1 n_2 n_3
def rj = ARevoluteJoint n_1 n_2
def D = 1.
def d = AAngularDamper D n_1 n_2
def g = Gravity m n_1 n_3

def m = b;
        ra;
        rj;
        d;
        g

  ; x_m <- l

def main = {
  // exportDill2Modelica "Pendulum" m
  simulate m (0., 30.) 0.01
    [(x_m, "x"), (y_m, "y")
    // ,(vx_m, "vx"), (vy_m, "vy")
    // ,(Fx_m, "Fx"), (Fy_m, "Fy")
    ]
}
